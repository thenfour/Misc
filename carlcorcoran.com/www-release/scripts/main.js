var SK=SK||{};SK.App=function(){this.storageEngine=new SK.FakeStorage,this.cms=new SK.CMS({storageEngine:this.storageEngine,languages:[{lang:"en-US",anchorID:"taalEN"},{lang:"nl-BE",anchorID:"taalNL"},{lang:"fr-BE",anchorID:"taalFR"}]});if(isAudioSupported()){var e=!1;this.audioEngine=new SK.Audio(this.storageEngine,{playElementID:"playButton",pauseElementID:"pauseButton",previousSongElementID:"previousSongButton",nextSongElementID:"nextSongButton",songNameElementID:"songName"},e,2e3)}else $("#mediaContainer").css("display","none");var t=new THREE.LoadingManager(bind(this,function(){$("#loading").hide(),this.beginGlsl()}));t.onProgress=function(e,t,n){$("#loading").text("loading: "+t+"/"+n)},(new THREE.TextureLoader(t)).load("images/1890dbg.png",bind(this,function(e){this.logoTexture=e})),(new THREE.XHRLoader(t)).load("shaders/main.glsl",bind(this,function(e){this.ps=e}))},SK.App.prototype.beginGlsl=function(){this.startTime=Date.now(),this.camera=new THREE.Camera,this.camera.position.z=0,this.scene=new THREE.Scene;var e=new THREE.PlaneBufferGeometry(2,2);this.uniforms={iGlobalTime:{type:"f",value:1},iResolution:{type:"v3",value:new THREE.Vector3},iDate:{type:"v4",value:new THREE.Vector4},iMouse:{type:"v4",value:new THREE.Vector4},iFFT:{type:"f",value:0},logoTexture:{type:"t",value:this.logoTexture},logoTextureSize:{type:"v2",value:new THREE.Vector2(this.logoTexture.image.width,this.logoTexture.image.height)}};var t=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:document.getElementById("vertexShader").textContent,fragmentShader:this.ps}),n=new THREE.Mesh(e,t);this.scene.add(n),this.renderer=new THREE.WebGLRenderer;var r=document.getElementById("glBody");r.appendChild(this.renderer.domElement),this.onWindowResize(),window.addEventListener("resize",bind(this,function(){this.onWindowResize()}),!1),this.doAnimFrame()},SK.App.prototype.uvToWindowCoords=function(e,t){var n={x:e.x,y:e.y};return t.x>t.y?n.x/=t.x/t.y:n.y*=t.x/t.y,n.x+=.5,n.y+=.7,n.x*=t.x,n.y*=t.y,n},SK.App.prototype.onWindowResize=function(){var e=window.innerWidth,t=window.innerHeight;this.uniforms.iResolution.value.x=e,this.uniforms.iResolution.value.y=t,this.uniforms.iResolution.value.z=0,this.renderer.setSize(e,t);var n={x:e,y:t},r=this.uvToWindowCoords({x:-0.5,y:0},n),i=this.uvToWindowCoords({x:.5,y:.5},n);r.x=Math.min(Math.max(0,r.x),n.x),r.y=Math.min(Math.max(0,r.y),n.y),i.x=Math.min(Math.max(0,i.x),n.x),i.y=Math.min(Math.max(0,i.y),n.y),$("#desc").css({top:r.y+"px",left:r.x+"px",width:Math.abs(i.x-r.x)+"px",height:Math.abs(i.y-r.y)+"px"})},SK.App.prototype.doAnimFrame=function(){requestAnimationFrame(bind(this,function(){this.doAnimFrame()})),this.drawScene()},SK.App.prototype.drawScene=function(){var e=Date.now();this.uniforms.iGlobalTime.value=(e-this.startTime)*.001,this.uniforms.iDate.value.x=e.year,this.uniforms.iDate.value.y=e.month,this.uniforms.iDate.value.z=e.day,this.uniforms.iDate.value.w=e.second+e.milliseconds,this.uniforms.iMouse.value.x=0,this.uniforms.iMouse.value.y=0,this.uniforms.iMouse.value.z=0,this.uniforms.iMouse.value.w=0,this.uniforms.iFFT.value=0,this.renderer.render(this.scene,this.camera)},window.onload=function(){window.slashKickApp=new SK.App},define("main",function(){});